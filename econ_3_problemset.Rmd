---
title: "econ_3"
author: "Lydia Bleifuss"
date: "5/15/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#set up 
library(tidyverse)
library(rootSolve)
library(reconPlots)
```

```{r}
#read in data
whale_data <- read.csv("HW3Data.csv")
whale_data

#1. Create a linear probability model that predicts a respondent’s probability of voting ‘yes’ on the ballot based on their age, income, NEP score, the risk reduction offered by the program, and the cost of the program to that respondent. Show the model and interpret the regression coefficients.

#create regression model:

#risk 
#bid (annual payment for household, WTP/cost of program to the respondant)
#vote (0 or 1, no or yes)
#NEP (measure of environmental concern)
#income
#age

 
# A. Saturated model: contains all predictor variables 
whale_lm1 <- lm(vote ~ risk + bid + NEP + income + age , data = whale_data)
summary(whale_lm1)

summary(whale_lm1)
intercept <- whale_lm1$coefficients[1]
risk <- whale_lm1$coefficients[2]
bid <- whale_lm1$coefficients[3]
nep <- whale_lm1$coefficients[4]
income_one <- whale_lm1$coefficients[5]
income_poor <- whale_lm1$coefficients[6]
income_rich <- whale_lm1$coefficients[7]
income_veryrich <- whale_lm1$coefficients[8]
age_to50 <- whale_lm1$coefficients[9]
age_to40 <-  whale_lm1$coefficients[10]
age_to60 <-  whale_lm1$coefficients[11]
age_to30 <-  whale_lm1$coefficients[12]

#Interperet Regression Coefficients (google doc)
#Income: Middle
#Age: over sixty 

```

```{r}
#2. Based on this regression, what can you say about the value of a single prevented whale death? (Hint: Think about how risk reduction for all whales translates into the number of whale deaths avoided)

#Hints
#Solve for bid
#Risk Reduction (20%), 5 whales saved, this is a constant 

#1. Rearranged equation in terms of bid ~ other variables
#2. Multipled each calculated coefficient by 0.04 (20% / 5 whales = 4% or 0.04), determine WTP for vessel speed reduction programs from 0 - 4% 
#3. Total value to mitigate death of one whale = $2.7834

tot_ave_vote <- mean(whale_data$vote) 
tot_ave_vote # 0.714
tot_ave_nep <- mean(whale_data$NEP)
tot_ave_nep # 38.366

#Average Vote: 0.714
#Average NEP: 38.366
#Assuming age to 30 and poor income. 

#0%
bid_zero <- (intercept + age_to30 + income_poor + (nep*tot_ave_nep) + (risk*0) - tot_ave_vote)/(-1*bid)

bid_zero #35.06003 

#4%
bid_four <- (intercept + age_to30 + income_poor + (nep*tot_ave_nep) + (risk*4) - tot_ave_vote)/(-1*bid)

bid_four #37.84343

wtp_one_whale <- bid_four - bid_zero
wtp_one_whale #2.7834 


```

```{r}
#3. Pick three arbitrary respondents. For each of those respondents, estimate their WTP for a VSR program offering 60% risk reduction.

# Random participants chosen and their WTP for VSR Progam: 

#71: income_poor, age_to50, NEP: 27

bid_71 <- (intercept + age_to50 + income_poor + (nep*27) + (risk*60)-tot_ave_vote)/(-1*bid)
bid_71 # -101.4938

#269: income_veryrich, age_to40, NEP: 32

bid_269 <- (intercept + age_to40 + income_veryrich + (nep*32) + (risk*60)-tot_ave_vote)/(-1*bid)
bid_269 #  -14.31479 

#336: income_rich, age_to30, NEP: 55

bid_336 <- (intercept + age_to30 + income_rich + (nep*55) + (risk*60)-tot_ave_vote)/(-1*bid)
bid_336 #  327.8921 


```

```{r}
#4 Now repeat this process and estimate the mean WTP for a VSR program offering 60% risk reduction among Santa Barbara County households.

tot_ave_vote <- mean(whale_data$vote) 
tot_ave_vote # 0.714

tot_ave_nep <- mean(whale_data$NEP)
tot_ave_nep # 38.366

ave_inc <- whale_data %>% 
  count(income == "very_rich", income == "rich", income == "poor", income == "one_percent", income == "middle")

ave_inc # income_rich  


ave_age <- whale_data %>% 
  count(age == "tothirty", age == "toforty", age == "tofifty", age == "tosixty", age == "oversixty")

ave_age # age_to50


# Use the average NEP, middle income, and middle age bracket (to 50) to find the average bid
bid_county <- (intercept + age_to50 + (nep*tot_ave_nep) + (risk*60) - tot_ave_vote)/(-1*bid)

bid_county
#  64.47601


```

