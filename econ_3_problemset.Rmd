---
title: "econ_3"
author: "Lydia Bleifuss"
date: "5/15/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#set up 
library(tidyverse)
library(rootSolve)
library(reconPlots)
```

```{r}
#read in data
whale_data <- read.csv("HW3Data.csv")
whale_data

#PART 1##########

#create regression model:

#risk 
#bid (annual payment for household, WTP/cost of program to the respondant)
#vote (0 or 1, no or yes)
#NEP (measure of environmental concern)
#income
#age

 
# A. Saturated model: contains all predictor variables 
whale_lm1 <- lm(vote ~ risk + bid + NEP + income + age , data = whale_data)
summary(whale_lm1)

summary(whale_lm1)
intercept <- whale_lm1$coefficients[1]
risk <- whale_lm1$coefficients[2]
bid <- whale_lm1$coefficients[3]
nep <- whale_lm1$coefficients[4]
income_one <- whale_lm1$coefficients[5]
income_poor <- whale_lm1$coefficients[6]
income_rich <- whale_lm1$coefficients[7]
income_veryrich <- whale_lm1$coefficients[8]
age_to50 <- whale_lm1$coefficients[9]
age_to40 <-  whale_lm1$coefficients[10]
age_to60 <-  whale_lm1$coefficients[11]
age_to30 <-  whale_lm1$coefficients[12]

#Interperet Regression Coefficients (google doc)
#Income: Middle
#Age: over sixty 
```

```{r}
#2. Based on this regression, what can you say about the value of a single prevented whale death? (Hint: Think about how risk reduction for all whales translates into the number of whale deaths avoided)

#Hints
#Solve for bid
#Risk Reduction (20%), 5 whales saved, this is a constant 

#1. Rearranged equation in terms of bid ~ other variables
#2. Multipled each calculated coefficient by 0.04 (20% / 5 whales = 4% or 0.04), determine WTP for vessel speed reduction programs from 0 - 4% 
#3. Total value to mitigate death of one whale = $2.7834

tot_ave_vote <- mean(whale_data$vote) 
tot_ave_vote # 0.714
tot_ave_nep <- mean(whale_data$NEP)
tot_ave_nep # 38.366

#Average Vote: 0.714
#Average NEP (WTP): 38.366

#0%
bid_zero <- (intercept + age_to30 + income_poor + (nep*tot_ave_nep) + (risk*0) - tot_ave_vote)/bid

bid_zero # -35.06003 

#4%
bid_four <- (intercept + age_to30 + income_poor + (nep*tot_ave_nep) + (risk*4) - tot_ave_vote)/bid

bid_four #-37.84343


wtp_one_whale <- bid_zero - bid_four
wtp_one_whale #2.7834 


```

